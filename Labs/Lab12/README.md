# Лабораторная работа №12. iBGP.

### Задание:

1. Настроить iBGP в офисе Москва между маршрутизаторами R14 и R15;
2. Настроите iBGP в провайдере Триада;
3. Настроить офис Москва так, чтобы приоритетным провайдером стал Ламас;
4. В офисе С.-Петербург работает протокол iBGP. (Не использовать протокол OSPF);
5. Настроить офис С.-Петербург так, чтобы трафик до любого офиса распределялся по двум линкам одновременно;
6. Все сети в лабораторной работе должны иметь IP связность;
7. План работы и изменения зафиксированы в документации.

Конфигурационные файлы [здесь](config/)

### Решение:


### Топология


#### 1. Настроить iBGP в офисе Москва между маршрутизаторами R14 и R15

Настроим на роутерах R14 и R15 параметры:
- __router-id__ для BGP;
- __next-hop-self__;
- __source-update__;
- __static route__ до сети соседнего ISP;
  


<details>
 <summary>Настройки iBGP между R14-R15</summary>

``` bash
#################
# Настройки R14 #
#################

conf t
router bgp 1001
 router-id 0.0.1.14
 neighbor 10.1.12.15 remote-as 1001
 neighbor 10.1.12.15 source-update Lo 999
 neighbor 10.1.12.15 next-hop-self
 neighbor 2001:FFCC:1000:1415::15 remote-as 1001
 neighbor 2001:FFCC:1000:1415::15 source-update LL
 neighbor 2001:FFCC:1000:1415::15 next-hop-self

ip route 2.2.2.0 255.255.255.224 10.1.12.15 

#################
# Настройки R15 #
#################

Настройка R15

conf t
router bgp 1001
 router-id 0.0.1.15
 neighbor 10.1.12.14 remote-as 1001
 neighbor 10.1.12.14 source-update Lo 999
 neighbor 10.1.12.14 next-hop-self
 neighbor 2001:FFCC:1000:1415::14 remote-as 1001
 neighbor 2001:FFCC:1000:1415::14 source-update LL
 neighbor 2001:FFCC:1000:1415::14 next-hop-self

ip route 7.7.7.0 255.255.255.224 10.1.12.14

```
</details>

### Балансировка

Балансировка исходящего трафика, для большинства провайдеров, не столь критична, поэтому темой статьи является управление именно входящим трафиком. Нам нужно разложить наш трафик по двум каналам: